---
alwaysApply: true
---
When creating functions that interact with the Postman API in files like `sync-postman-spec.js`:

## Ground Rules

 - DO NOT MAKE ASSUMPTIONS!  Follow the OAS definition in postmanAPISpec.yaml precisely.  Do not amake assumptions about API response structure.  If the spec is unclear, prompt me.  
 - DO NOT go beyond your instructions.  Create only the code, tests specified in these rules unless specifically prompted otherwise.  

 

## Function Structure
- Use async/await pattern
- Functions should NOT take `apiKey` as a parameter - use the `apiKey` variable from the outer scope (defined at the top of the file from `process.env.POSTMAN_API_KEY_POSTMAN`)
- Use axios for HTTP requests
- Return the axios response directly
- Create axios configs using the buildAxiosConfig function
- Execute requests using  the ExecuteRequest function
- NEVER add more code than is the absolute necessity to fulfill your rules
- DO NOT attempt to validate body content or other parameters
- if a parameter is NOT marked as required in postmanAPIspec.yaml, default it to null and DO NOT include it in query strings or the request body

## naming conventions
- Function names should be prepended with the following based on the HTTP method
    - GET  = get
    - POST = create
    - PUT = update
    - PATCH = modify
    - DELETE = delete
  

## Standard Pattern
/**
 * [Brief description of what the function does]
 * Postman API endpoint and method (eg POST /specs/{specId}/files)
 * @param {string} param1 - Description
 * @param {string} param2 - Description
 * @param {string} param3 - Description
 * @returns {Promise} Axios response
 */
async function functionName(data = null, param1, param2) {
  const endpoint = `/path/${param1}/path`;
  const config = buildAxiosConfig('post', endpoint, { // or 'get', 'patch', 'put', 'delete' etc. 
    path: @param3,
    content: data // If the endpoint has a body and requires content.  Otherwise default to null and DO NOT include the content property here
  });
  return await executeRequest(config);
}

## ID vs. UID
 - Some API endpoints use an object ID and some use a UID.  The UID is constructed by prepending the ID with the UserID of the currently authenticated user: 
  - collectionId: d4dd588d-111f-4651-b64d-463e4b093f4b
  - collectionUid: 34829850-d4dd588d-111f-4651-b64d-463e4b093f4b
 - Code should identify whether an endpoint requires an ID or a UID 
 - Initialization code should call the /me endpoint, retrieve the currently authenticated userId from the 'id' property of the response, and persist that to test-ids.json.  
 - In unit tests always use a 36 character value for mock objectIds.  



## Responses
1. Read and apply the documentation in the OAS to determine the shape of request and response payloads.  Do not assume payload properties which don't exist. 

## Example Reference
See `createSpecFile` function in `pmansdkexample.js` as the reference implementation.

## Key Rules
0. Always use vanilla NodeJS, no typescript
1. Assume an APIKey exists in an environment variable POSTMAN_API_KEY
2. Always include 'Content-Type': 'application/json' header
3. Always include 'X-API-Key': apiKey header
4. Use JSDoc comments for documentation.  Enrich with information from the spec, including all query, path and body parameters as well as examples.  
5. Return the axios response promise directly
6. Follow the same structure as `createSpecFile` function
8. Do not repeat yourself.  Abstract reused code into named functions.
9. DO NOT perform additional work.  
10. Create unit, functional and end-to-end JEST tests modules for each api module
11. Functional tests should NOT use mocks, they should use the actual SDK and make actual API calls.  
12. Functional tests should run in the following order: 
   - Create
   - get
   - modify
   - delete
13. all functional tests should use persisted values for properties like workspaceId.  
14. All API calls should throw an error on a non-success response from the API, and include the API response in the error.
15. Content for specs could be either JSON or YAML.  Ensure tests on these objects seamlessly handle either JSON or YAML.  
 - Example: Asserting a property exists in content: 
      const specDefinition = parseContent(result.data.definition);
      expect(result.data).toHaveProperty('definition');
16. 'Update documentation' includes:
 - .github/**/*.md
 - ./src/**/*.md 
 - ./docs/**/*.md 
 - ./scripts/**/*.md 
 - ./fixtures/**/*.md 
17. Do not update documentation until told to do so
18. DO NOT CREATE SUMMARY DOCUMENTS UNLESS INSTRUCTED TO SO SO
19. Exclude all /api endpoints from API-ENDPOINTS-TODO.md
20. Organize test suites as instructed.  